<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Telegram WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
        }
        button { 
            display: block; 
            width: 100%; 
            padding: 15px; 
            margin: 10px 0; 
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #fff);
            border: none; 
            border-radius: 8px; 
            font-size: 16px;
            cursor: pointer;
        }
        .info { 
            background: #f0f0f0; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px;
            font-size: 12px;
        }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ØªØ´Ø®ÙŠØµ Telegram WebApp</h1>
    
    <div id="info" class="info">
        <div><strong>Ø­Ø§Ù„Ø© WebApp:</strong> <span id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</span></div>
        <div><strong>Ø§Ù„Ù…Ù†ØµØ©:</strong> <span id="platform">-</span></div>
        <div><strong>Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</strong> <span id="version">-</span></div>
        <div><strong>Ø§Ù„Ø¨ÙŠØ¦Ø©:</strong> <span id="environment">-</span></div>
    </div>

    <button onclick="testBasic()">1ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Ø£Ø³Ø§Ø³ÙŠ - sendData</button>
    <button onclick="testWithValidation()">2ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚</button>
    <button onclick="testMainButton()">3ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± MainButton</button>
    <button onclick="testHaptic()">4ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Haptic</button>
    <button onclick="testAlert()">5ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Alert</button>
    <button onclick="testExpand()">6ï¸âƒ£ Ø§Ø®ØªØ¨Ø§Ø± Expand</button>

    <div id="results"></div>

    <script>
        let tg = window.Telegram?.WebApp;
        
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `info ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        function updateInfo() {
            const status = document.getElementById('status');
            const platform = document.getElementById('platform');
            const version = document.getElementById('version');
            const environment = document.getElementById('environment');

            if (!window.Telegram) {
                status.textContent = 'âŒ Telegram ØºÙŠØ± Ù…ØªÙˆÙØ±';
                log('âŒ window.Telegram ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            if (!tg) {
                status.textContent = 'âŒ WebApp ØºÙŠØ± Ù…ØªÙˆÙØ±';
                log('âŒ Telegram.WebApp ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                return;
            }

            status.textContent = 'âœ… Ù…ØªØµÙ„';
            platform.textContent = tg.platform || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            version.textContent = tg.version || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            environment.textContent = tg.isExpanded ? 'Ù…ÙˆØ³Ø¹' : 'Ù…ØµØºØ±';

            log(`âœ… WebApp Ø¬Ø§Ù‡Ø² - Platform: ${tg.platform}, Version: ${tg.version}`, 'success');
            log(`ğŸ“± ViewportHeight: ${tg.viewportHeight}, isExpanded: ${tg.isExpanded}`);
            log(`ğŸ¨ colorScheme: ${tg.colorScheme}, themeParams: ${JSON.stringify(tg.themeParams)}`);
        }

        function testBasic() {
            log('ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ...');
            
            if (!tg) {
                log('âŒ Telegram WebApp ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
                return;
            }

            try {
                const data = {
                    test: 'basic',
                    timestamp: Date.now(),
                    platform: tg.platform
                };
                
                log(`ğŸ“¤ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø³Ø§Ù„: ${JSON.stringify(data)}`);
                tg.sendData(JSON.stringify(data));
                log('âœ… ØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ sendData Ø¨Ù†Ø¬Ø§Ø­', 'success');
                
                // Ù„Ø§ Ù†ØºÙ„Ù‚ WebApp ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                // tg.close();
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ sendData: ${error.message}`, 'error');
            }
        }

        function testWithValidation() {
            log('ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­Ù‚Ù‚...');
            
            if (!tg?.sendData) {
                log('âŒ sendData ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
                return;
            }

            if (!tg.initData) {
                log('âš ï¸ ØªØ­Ø°ÙŠØ±: initData ÙØ§Ø±Øº - Ù‚Ø¯ Ù„Ø§ ÙŠÙƒÙˆÙ† WebApp Ù…ÙØªÙˆØ­ Ù…Ù† ØªÙ„ÙŠØ¬Ø±Ø§Ù…', 'error');
            }

            try {
                const data = {
                    test: 'validation',
                    initData: tg.initData,
                    initDataUnsafe: tg.initDataUnsafe,
                    timestamp: Date.now()
                };
                
                log(`ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚: ${JSON.stringify(data, null, 2)}`);
                tg.sendData(JSON.stringify(data));
                log('âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚', 'success');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
            }
        }

        function testMainButton() {
            log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± MainButton...');
            
            if (!tg?.MainButton) {
                log('âŒ MainButton ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
                return;
            }

            try {
                tg.MainButton.setText('ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± MainButton');
                tg.MainButton.onClick(() => {
                    log('ğŸ”˜ ØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ MainButton');
                    const data = { test: 'mainButton', timestamp: Date.now() };
                    tg.sendData(JSON.stringify(data));
                    log('âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± MainButton', 'success');
                });
                tg.MainButton.show();
                log('âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ MainButton', 'success');
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ MainButton: ${error.message}`, 'error');
            }
        }

        function testHaptic() {
            log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Haptic Feedback...');
            
            try {
                tg.HapticFeedback?.impactOccurred('medium');
                log('âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Haptic Feedback', 'success');
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Haptic: ${error.message}`, 'error');
            }
        }

        function testAlert() {
            log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Alert...');
            
            try {
                tg.showAlert?.('Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù€ Alert ÙÙŠ WebApp');
                log('âœ… ØªÙ… Ø¹Ø±Ø¶ Alert', 'success');
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Alert: ${error.message}`, 'error');
            }
        }

        function testExpand() {
            log('ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Expand...');
            
            try {
                tg.expand?.();
                log('âœ… ØªÙ… ØªÙˆØ³ÙŠØ¹ WebApp', 'success');
                setTimeout(updateInfo, 500);
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Expand: ${error.message}`, 'error');
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„ØªØ´Ø®ÙŠØµ');
            
            if (tg) {
                tg.ready();
                log('âœ… ØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ tg.ready()');
                updateInfo();
            } else {
                log('âŒ Telegram WebApp ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
            }
        });

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø­Ø¯Ø§Ø« WebApp
        if (tg) {
            tg.onEvent?.('themeChanged', () => {
                log('ğŸ¨ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø«ÙŠÙ…');
                updateInfo();
            });

            tg.onEvent?.('viewportChanged', () => {
                log('ğŸ“± ØªÙ… ØªØºÙŠÙŠØ± Viewport');
                updateInfo();
            });
        }
    </script>
</body>
</html>
